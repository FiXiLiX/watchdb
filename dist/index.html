<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kovacevic Satovi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- SEO -->
<meta name="title" content="Kovacevic Satovi" />
<meta name="description" content="Polovni satovi vrhunskih brendova. Servisirani i spremni za nosenje!" />

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website" />
<meta property="og:url" content="https://kovacevic-satovi.com/" />
<meta property="og:title" content="Kovacevic Satovi" />
<meta property="og:description" content="Polovni satovi vrhunskih brendova. Servisirani i spremni za nosenje!" />
<meta property="og:image" content="https://i.ibb.co/tTz0V1bV/kovacevic-logo.png" />

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content="https://kovacevic-satovi.com/" />
<meta property="twitter:title" content="Kovacevic Satovi" />
<meta property="twitter:description" content="Polovni satovi vrhunskih brendova. Servisirani i spremni za nosenje!" />
<meta property="twitter:image" content="https://i.ibb.co/tTz0V1bV/kovacevic-logo.png" />

<style>
body { 
  margin:0; 
  font-family: Arial, sans-serif; 
  background:#121212; 
  color:#eee; 
  display:flex; 
  flex-direction:column; 
  min-height:100vh; 
  font-size:16px;
  line-height:1.6;
}

header { 
  padding:10px; 
  text-align:center; 
  background:#1e1e1e; 
  border-bottom:1px solid #444; 
}
header img { height:110px; }

.container { 
  display:flex; 
  flex-wrap:wrap; 
  gap:20px; 
  padding:20px; 
  justify-content:center; 
}

.watch-card { 
  background:#1e1e1e; 
  padding:15px; 
  border-radius:8px; 
  width:300px; 
  box-sizing:border-box; 
  display:flex; 
  flex-direction:column; 
  gap:10px; 
  transition:0.2s; 
  cursor:pointer; 
}
.watch-card:hover { 
  transform:scale(1.02); 
  border:1px solid #555; 
}
.watch-card img { 
  width:100%; 
  height:auto; 
  max-height:500px; 
  object-fit:contain; 
  border-radius:6px; 
}
.watch-card h2 { margin:0; font-size:20px; }
.price { font-weight:bold; font-size:16px; margin-top:5px; }

#modal { 
  display:none; 
  position:fixed; 
  top:0; 
  left:0; 
  width:100%; 
  height:100%; 
  background:rgba(0,0,0,0.9); 
  justify-content:center; 
  align-items:center; 
  z-index:1000; 
}
.modal-content { 
  display:flex; 
  gap:20px; 
  max-width:1000px; 
  width:90%; 
  max-height:90%; 
  background:#1e1e1e; 
  padding:20px; 
  border-radius:10px; 
  overflow:auto; 
  position:relative;
}
.modal-left { 
  flex:1; 
  display:flex; 
  flex-direction:column; 
  align-items:center; 
  gap:10px; 
}
.modal-left img { 
  width:100%; 
  max-height:85vh; 
  object-fit:contain; 
  border-radius:6px; 
}
.modal-right { 
  flex:1; 
  display:flex; 
  flex-direction:column; 
  gap:10px; 
}
.modal-right h2 { margin:0; }
.modal-right p { margin:2px 0; }

#modalClose { 
  position:absolute; 
  top:20px; 
  right:30px; 
  font-size:28px; 
  cursor:pointer; 
  color:#fff; 
  z-index:2000;
}

.nav-btn { 
  font-size:28px; 
  cursor:pointer; 
  color:#fff; 
  user-select:none; 
  margin:0 10px; 
}
.image-nav { 
  display:flex; 
  justify-content:center; 
  gap:10px; 
  align-items:center; 
  margin-top:5px; 
}
.image-thumbnails { 
  display:flex; 
  flex-wrap:wrap; 
  gap:10px; 
  justify-content:center; 
}
.image-thumbnails img { 
  width:70px; 
  height:70px; 
  object-fit:contain; 
  border-radius:4px; 
  cursor:pointer; 
  border:2px solid #444; 
  transition:0.2s; 
}
.image-thumbnails img.active { border:2px solid #fff; }

footer { 
  margin-top:auto; 
  background:#1e1e1e; 
  text-align:center; 
  padding:20px 10px; 
  border-top:1px solid #444; 
}
.footer-content {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:10px;
}
.footer-brand {
  font-size:14px;
  color:#aaa;
}
.footer-links {
  display:flex;
  gap:15px;
}
.footer-links a { 
  color:#eee; 
  text-decoration:none; 
  font-size:16px; 
  transition:color 0.2s;
}
.footer-links a:hover { color:#E1306C; }
.footer-instagram {
  display:inline-flex;
  align-items:center;
  gap:6px;
  background:#E1306C;
  padding:8px 14px;
  border-radius:6px;
  color:#fff !important;
  font-weight:bold;
}
.footer-instagram:hover { background:#c72a5a; }

@media (max-width:1000px){
  body { font-size:20px; }
  .container { padding:8px; gap:10px; }
  .watch-card { width:100%; padding:10px; gap:6px; }
  .watch-card h2 { font-size:22px; }
  .watch-card img { max-height:600px; }
  .price { font-size:18px; }
  .modal-content { flex-direction:column; padding:10px; gap:10px; }
  .modal-left img { max-height:45vh; }
  .modal-right h2 { font-size:22px; }
  .modal-right p { font-size:18px; }
  .image-thumbnails img { width:48px; height:48px; }
  #modalClose { top:10px; right:14px; font-size:36px; z-index:2000; }
  .footer-content { gap:6px; }
  .footer-brand { font-size:13px; }
  .footer-links a, .footer-instagram { font-size:18px; padding:8px 10px; }
}
</style>
</head>
<body>

<header>
  <img src="/logo.png" alt="Logo">
</header>

<div class="container" id="watchContainer"></div>

<div id="modal">
  <div id="modalClose">‚úñ</div>
  <div class="modal-content">
    <div class="modal-left">
      <img id="modalImg" src="">
      <div class="image-nav">
        <span class="nav-btn" id="prevImg">‚óÄ</span>
        <span class="nav-btn" id="nextImg">‚ñ∂</span>
      </div>
      <div class="image-thumbnails" id="thumbnails"></div>
    </div>
    <div class="modal-right" id="modalDetails"></div>
  </div>
</div>

<footer>
  <div class="footer-content">
    <div class="footer-links">
      <a href="https://www.instagram.com/kovacevic.satovi/" target="_blank" class="footer-instagram">Instagram</a>
    </div>
    <div class="footer-brand">¬© 2025 Kovaƒçeviƒá Satovi. All rights reserved.</div>
  </div>
</footer>

<script>
let watches = [];
let currentWatch = null;
let popupIndex = 0;

fetch('/watches.json')
  .then(res => res.json())
  .then(json => {
    watches = Object.keys(json).map(key => ({ key, ...json[key] }));
    renderWatches();

    const params = new URLSearchParams(window.location.search);
    const itemKey = params.get("item");
    if (itemKey) {
      const idx = watches.findIndex(w => w.key === itemKey);
      if (idx >= 0) openModal(idx, false);
    }
  })
  .catch(err => console.error("Failed to load JSON:", err));

function renderWatches(){
  const container = document.getElementById('watchContainer');
  container.innerHTML = '';
  watches.forEach((watch, idx)=>{
    const card = document.createElement('div');
    card.className = 'watch-card';
    card.onclick = ()=>openModal(idx, true);

    const img = document.createElement('img');
    img.src = watch.images && watch.images[0] || '';

    const title = document.createElement('h2'); title.textContent = watch.name;
    const price = document.createElement('div'); price.className='price'; price.textContent = watch.price;

    const color = document.createElement('p'); color.innerHTML = `<b>Color:</b> ${watch.color}`;
    const caseSize = document.createElement('p'); caseSize.innerHTML = `<b>Case Size:</b> ${watch.case_size}`;

    card.append(img,title,price,color,caseSize);
    container.appendChild(card);
  });
}

function openModal(idx, push=true){
  currentWatch = watches[idx];
  popupIndex = 0;
  updateModal();
  document.getElementById('modal').style.display = 'flex';

  if (push) {
    const params = new URLSearchParams(window.location.search);
    params.set("item", currentWatch.key);
    history.pushState({ modal:true }, "", "?" + params.toString());
  }
}

function closeModal(pop=true){
  document.getElementById('modal').style.display='none';
  currentWatch = null;
  if (pop) {
    const params = new URLSearchParams(window.location.search);
    params.delete("item");
    history.pushState({}, "", window.location.pathname + (params.toString() ? "?" + params.toString() : ""));
  }
}

function updateModal(){
  const img = document.getElementById('modalImg');
  img.src = currentWatch.images && currentWatch.images[popupIndex] || '';

  const details = document.getElementById('modalDetails');
  details.innerHTML = `
    <h2>${currentWatch.name}</h2>
    <p><b>Price:</b> ${currentWatch.price}</p>
    <p><b>Color:</b> ${currentWatch.color}</p>
    <p><b>Case Size:</b> ${currentWatch.case_size}</p>
    <p><b>Movement:</b> ${currentWatch.movement}</p>
    <p><b>Country:</b> ${currentWatch.country}</p>
    <p><b>Bracelet:</b> ${currentWatch.bracelet}</p>
    <p><b>Description:</b> ${currentWatch.description}</p>
    <a href="https://www.instagram.com/kovacevic.satovi/" target="_blank" style="margin-top:10px;display:inline-block;padding:10px 15px;background:#E1306C;color:#fff;border-radius:6px;text-decoration:none;">üì∑ Order via Instagram</a>
  `;

  const thumbs = document.getElementById('thumbnails');
  thumbs.innerHTML = '';
  if(currentWatch.images){
    currentWatch.images.forEach((src,i)=>{
      const t=document.createElement('img');
      t.src=src;
      if(i===popupIndex) t.classList.add('active');
      t.onclick=()=>{ popupIndex=i; updateModal(); };
      thumbs.appendChild(t);
    });
  }
}

document.getElementById('modalClose').onclick = ()=>closeModal();

document.getElementById('prevImg').onclick = ()=>{ 
  if(!currentWatch.images) return; 
  popupIndex=(popupIndex-1+currentWatch.images.length)%currentWatch.images.length; 
  updateModal();
}
document.getElementById('nextImg').onclick = ()=>{ 
  if(!currentWatch.images) return; 
  popupIndex=(popupIndex+1)%currentWatch.images.length; 
  updateModal();
}

document.addEventListener('keydown', e=>{
  if(document.getElementById('modal').style.display!=='flex') return;
  if(e.key==='ArrowLeft') document.getElementById('prevImg').click();
  if(e.key==='ArrowRight') document.getElementById('nextImg').click();
  if(e.key==='Escape') closeModal();
});

document.getElementById('modal').addEventListener('click', e => {
  if (e.target.id === 'modal') {
    closeModal();
  }
});

// Handle back/forward navigation
window.addEventListener("popstate", () => {
  const params = new URLSearchParams(window.location.search);
  const itemKey = params.get("item");
  if (itemKey && !currentWatch) {
    const idx = watches.findIndex(w => w.key === itemKey);
    if (idx >= 0) openModal(idx, false);
  } else if (!itemKey && currentWatch) {
    closeModal(false);
  }
});
</script>

</body>
</html>
